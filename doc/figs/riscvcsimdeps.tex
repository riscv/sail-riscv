\documentclass[tikz]{standalone}

\usepackage{tikz}
\usetikzlibrary{calc,positioning,backgrounds}

\begin{document}
\begin{tikzpicture}[
    % these two lines are needed for the svg to receive a filled background.
    background rectangle/.style={rounded corners,fill=gray!20},
    framed,
    % general settings
    node distance=5mm,
    align=center,
    % nodes
    base/.style={rectangle, rounded corners=3mm, minimum size=10mm, thick, draw=black,fill=white},
    cmodel/.style={base, fill=green!30},
    sail/.style={base, fill=cyan!40},
    c/.style={base},
    csail/.style={base,fill=cyan!20},
    cfg/.style={base,double=teal!50, double distance=0.25em},
    schema/.style={base,fill=violet!20},
    % arrows
    dep/.style={black, very thick},
    gen/.style={blue, very thick},
    valid/.style={purple, very thick},
  ]

  \pgfdeclarelayer{background}
  \pgfdeclarelayer{arrows} % arrows directly on the background layer don't seem to show
  \pgfsetlayers{background,arrows,main}

  \pgfonlayer{main}

  \node (cmodel)     [cmodel]                        {\textbf{C translation}\\
                                                         \texttt{sail\_riscv\_model}};

  \node (csim)       [c, above left=of cmodel]       {\textbf{C++ Simulator}\\
                                                         \texttt{sail\_riscv\_sim}\\
                                                         command line options\\
                                                         initialization\\
                                                         exit code};

  \node (callbacks)  [c, below left=of cmodel]       {\textbf{Callbacks}\\
                                                         \texttt{riscv\_callbacks.\{sail,cpp\}}\\
                                                         state-change callbacks\\
                                                         logging};
  \coordinate (smloc) at ($(cmodel)+(0,4.5)$);
  \node (sailmodel)  [sail] at (smloc)               {\textbf{Sail model}\\
                                                         \texttt{*.sail}};

  \node (plat)       [c, below right=of cmodel]      {\textbf{C platform interface}\\
                                                         \texttt{riscv\_platform}\\
                                                         \textsc{lr/sc} reservation};

  \node (cfg)        [cfg, above=of plat]            {\textbf{Model configuration}\\
                                                         ISA options\\
                                                         memory map\\
                                                         enabled extensions};

  \node (schema)     [schema, above=of cfg]          {\textbf{Configuration Schema}\\
                                                         \texttt{sail\_riscv\_config\_schema.json}\\
                                                         legal configuration values};

  \node (platimpl)   [c, below=of plat]              {\textbf{C platform implementation}\\
                                                         \texttt{riscv\_platform\_impl}};

  \coordinate (clib) at ($(cmodel)!1.5!(cmodel |- platimpl)$);
  \node (csail)      [csail]  at (clib)              {\textbf{C Sail library}\\
                                                         \texttt{sail,rts}\\
                                                         Sail values\\
                                                         raw memory};

  \endpgfonlayer

  \pgfonlayer{arrows}

  \draw[->,gen]  (sailmodel) edge                    (cmodel)
                             edge                    (schema);

  \draw[->,valid] (schema)   edge                    (cfg);

  \draw[->,dep]  (cmodel)    edge                    (plat)
                             edge                    (csail)
                             edge                    (callbacks)
                             edge                    (cfg);

  \draw[->,dep]  (plat)      edge                    (platimpl);

  \draw[->,dep]  (platimpl)  edge                    (csail);

  \draw[->,dep]  (csim)      edge                    (cmodel)
                             edge                    (callbacks)
                             edge [out=-90,in=180]   (platimpl)
                             edge [out=-90,in=135]   (csail);

  \endpgfonlayer
\end{tikzpicture}
\end{document}
